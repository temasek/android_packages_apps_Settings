From ec0ba63038377c48786d6640edc11a3aea210c9a Mon Sep 17 00:00:00 2001
From: ValeraSh <9144287@gmail.com>
Date: Mon, 16 Dec 2013 19:01:59 +0300
Subject: [PATCH 46/56] Delete locbase.diff

---
 locbase.diff | 53 -----------------------------------------------------
 1 file changed, 53 deletions(-)
 delete mode 100644 locbase.diff

diff --git a/locbase.diff b/locbase.diff
deleted file mode 100644
index 302385a..0000000
--- a/locbase.diff
+++ /dev/null
@@ -1,53 +0,0 @@
-diff --git "a/D:\\Temp\\TortoiseGit\\Loc40E8.tmp\\LocationSettingsBase-a306630-left.java" "b/D:\\Temp\\TortoiseGit\\Loc40E7.tmp\\LocationSettingsBase-4528e68-right.java"
-index 86c2ee5..c160833 100644
---- "a/D:\\Temp\\TortoiseGit\\Loc40E8.tmp\\LocationSettingsBase-a306630-left.java"
-+++ "b/D:\\Temp\\TortoiseGit\\Loc40E7.tmp\\LocationSettingsBase-4528e68-right.java"
-@@ -71,13 +71,13 @@ public abstract class LocationSettingsBase extends SettingsPreferenceFragment
-     /** Called when location mode has changed. */
-     public abstract void onModeChanged(int mode, boolean restricted);
- 
--    private boolean isRestricted() {
--        final UserManager um = (UserManager) getActivity().getSystemService(Context.USER_SERVICE);
-+    protected static boolean isRestricted(Context context) {
-+        final UserManager um = (UserManager) context.getSystemService(Context.USER_SERVICE);
-         return um.hasUserRestriction(UserManager.DISALLOW_SHARE_LOCATION);
-     }
- 
-     public void setLocationMode(int mode) {
--        if (isRestricted()) {
-+        if (isRestricted(getActivity())) {
-             // Location toggling disabled by user restriction. Read the current location mode to
-             // update the location master switch.
-             if (Log.isLoggable(TAG, Log.INFO)) {
-@@ -90,20 +90,25 @@ public abstract class LocationSettingsBase extends SettingsPreferenceFragment
-             }
-             return;
-         }
--        Intent intent = new Intent(MODE_CHANGING_ACTION);
--        intent.putExtra(CURRENT_MODE_KEY, mCurrentMode);
--        intent.putExtra(NEW_MODE_KEY, mode);
--        getActivity().sendBroadcast(intent, android.Manifest.permission.WRITE_SECURE_SETTINGS);
--        Settings.Secure.putInt(getContentResolver(), Settings.Secure.LOCATION_MODE, mode);
-+        sendModeChangingIntent(getActivity(), mCurrentMode, mode);
-         refreshLocationMode();
-     }
- 
-+    protected static void sendModeChangingIntent(Context context, int oldState, int newState) {
-+        Intent intent = new Intent(MODE_CHANGING_ACTION);
-+        intent.putExtra(CURRENT_MODE_KEY, oldState);
-+        intent.putExtra(NEW_MODE_KEY, newState);
-+        context.sendBroadcast(intent, android.Manifest.permission.WRITE_SECURE_SETTINGS);
-+        Settings.Secure.putInt(context.getContentResolver(),
-+                Settings.Secure.LOCATION_MODE, newState);
-+    }
-+
-     public void refreshLocationMode() {
-         if (mActive) {
-             int mode = Settings.Secure.getInt(getContentResolver(), Settings.Secure.LOCATION_MODE,
-                     Settings.Secure.LOCATION_MODE_OFF);
-             mCurrentMode = mode;
--            onModeChanged(mode, isRestricted());
-+            onModeChanged(mode, isRestricted(getActivity()));
-         }
-     }
- 
-- 
1.8.4.msysgit.0

